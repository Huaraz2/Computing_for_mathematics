<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <script src="https://d3eoax9i5htok0.cloudfront.net/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h1 id="week-8---differential-equations">Week 8 - Differential Equations</h1>
<p>Sage can be used to solve differential equations. Often complex systems can be modelled simply in terms of differential equations however solving these differential equations is not always straightforward (you will be studying differential equations a lot closer in the Spring semester). At the end of this week you will be able to:</p>
<ul>
<li>Solve differential equations using Sage;</li>
<li>Solve differential equations numerically using Sage;</li>
<li>Plot the results of the above.</li>
</ul>
<ol style="list-style-type: decimal">
<li><p><strong>TICKABLE</strong> The general syntax for solving a differential equation of the form \(f(x, y)== g(x, y)\) is shown below:</p>
<pre><code>desolve(f(x, y) == g(x, y), y)</code></pre>
<p>Try out the following code which solves the differential equation: \(\frac{dy}{dx}=y\).</p>
<pre><code>y = function(&#39;y&#39;, x)
desolve(diff(y, x) == y, y)</code></pre>
<p>Note that that there is no need to specify the independent variable (\(x\)). The following code solves the general form of the above equation: \(\frac{dy}{dx}=ky\) for some \(k\in\mathbb{R}\).</p>
<pre><code>var(&#39;k&#39;)
desolve(diff(y, x) == k * y, y, ivar=x)</code></pre></li>
<li><p>Once we have the solution to a differential equation it is very straightforward to plot it:</p>
<pre><code>y = function(&#39;y&#39;, x)
soln(x) = desolve(diff(y, x) == y, y)
plot(soln(x).subs(c=2), x, -10, 10)</code></pre>
<p>Note that we are here seeing the <code>subs</code> method which allows us to substitue a given value in an expression. It is very easy to get a whole family of plots:</p>
<pre><code>p = plot(soln(x).subs(c=0), x, -10, 10, color=rainbow(10[0]), legend_label=&quot;c=0&quot;)
for C in range(1, 11):
    p += plot(soln(x).subs(c=C), x, -10, 10, color=rainbow(10[C], legend_label=&quot;c=%s&quot; % C)
p.show()</code></pre>
<p>We are here making use of the Sage <code>rainbow</code> function which gives a list of colors that can be used in the plot <code>color</code> option. We are also making use of the <code>legend_label</code> option.</p>
<p>Obtain a similar plot for the solution to the differential equation: \(\frac{dy}{dx} = xy\).</p></li>
<li><p>There is nothing restricting us to only solving first order differential equations. The following differential equation can be used to model the position of a mass on a spring:</p>
<p>\[m\frac{d^2x}{dt^2}+c\frac{dx}{dt}+kx=0\]</p>
<p>Solve this equation.</p></li>
<li><p><strong>TICKABLE</strong> Solve the following differential equations and plot their solution (for the given particular value):</p>
<ol style="list-style-type: decimal">
<li>\(\frac{dy}{dx}+4y=5e^x\), (\(y(0)=3\))</li>
<li>\(\frac{dy}{dx}+\frac{x(2y-3)}{x^2+1}=\sin(x)\), (\(y(0)=4\))</li>
<li>\(\frac{d^2y}{dx^2}-y=\sin(5x)\), (\(y(3)=1\))</li>
<li>\(\frac{d^2y}{dx^2}+2\frac{dy}{dx}+2y=\cosh(t)\), (\(y(1)=2\))</li>
</ol></li>
<li><p>Systems of differential equations often arise and can also be solved using Sage. Take a look at the <code>desolve_system</code> function and solve the following system of differential equations:</p>
<p>\[\begin{cases}
\frac{dx}{dt} = 1 - y\\
\frac{dy}{dt} = 1 - x
\end{cases}\]</p></li>
<li><p>A battle between two armies can be modelled with the following set of differrential equations:</p>
<p>\[\begin{cases}
\frac{dx}{dt} = - y\\
\frac{dy}{dt} = -5x
\end{case}\]</p>
<p>Obtain the solution to this system of equations. Assuming that \(x(0)=100\) and that \(y(0)=700\) plot the two solutions of the equations, which army wins this battle? When does the battle end?</p></li>
<li><p><strong>TICKABLE</strong> The love story between Romero and Juliet can be modelled with the following system of differential equations:</p>
<p>\[\begin{cases}
\frac{dx}{dt} = -y\\
\frac{dy}{dt} = .7x
\end{case}\]</p>
<p>Where \(x(t)\) represents the affection of Juliet towards Romeo and \(y(t)\) the affection of Romeo towards Juliet (negative affection represents 'hatred').</p>
<p>Solve this system of equation and assuming that Romeo is initially attracted to Juliet (\(x(0)=1\)) but that Juliet is initially indifferent to Romeo (\(y(0)=0\)) at time \(t=0\) are indifferent to each other describe the long term relationship between the two characters.</p>
<p>Describe the behaviour of the system if Romeo and Juliet are initially indifferent to each other.</p></li>
<li><p><strong>TICKABLE</strong> Certain differential equations are much harder to solve than others. Attempt to solve the following differential equation using Sage:</p>
<p>\[\frac{dy}{dx} + y(y-1)==\abs(x-2)\]</p>
<p>In these situations certain numerical algorithms exist that can still describe the evolution of the system. Investigate the <code>desolve_rk4</code> function and obtain a solution for the above equation given that \(y(0)=1\) for \(x&lt;100\). Obtain a plot of the numerical solution</p></li>
<li><p>Write a function that will attempt to solve a differential equation analytically and if such a solution is not obtainable will solve it numerically. To do this you should investigate the python functions: <code>try</code> and <code>except</code>.</p></li>
</ol>
</body>
</html>
